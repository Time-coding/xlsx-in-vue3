import{r as b,a as x,o as v,E,b as S,c as T,d as k,e as w,u as q,w as _,F as O,f as j,g as M,h as B,i as C}from"./elementPlus.ff50657a.js";import{X as p}from"./xlsx.9c787818.js";import{S as h}from"./xDataSpreadsheet.3251f877.js";import"./lodash.5b4087a0.js";const P=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function o(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(t){if(t.ep)return;t.ep=!0;const n=o(t);fetch(t.href,n)}};P();(function(c){var l={};function o(e){if(l[e])return l[e].exports;var t=l[e]={i:e,l:!1,exports:{}};return c[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=c,o.c=l,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t||4&t&&typeof e=="object"&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&typeof e!="string")for(var i in e)o.d(n,i,function(r){return e[r]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=3)})({3:function(c,l,o){o.r(l);const e={toolbar:{undo:"\u64A4\u9500",redo:"\u6062\u590D",print:"\u6253\u5370",paintformat:"\u683C\u5F0F\u5237",clearformat:"\u6E05\u9664\u683C\u5F0F",format:"\u6570\u636E\u683C\u5F0F",fontName:"\u5B57\u4F53",fontSize:"\u5B57\u53F7",fontBold:"\u52A0\u7C97",fontItalic:"\u503E\u659C",underline:"\u4E0B\u5212\u7EBF",strike:"\u5220\u9664\u7EBF",color:"\u5B57\u4F53\u989C\u8272",bgcolor:"\u586B\u5145\u989C\u8272",border:"\u8FB9\u6846",merge:"\u5408\u5E76\u5355\u5143\u683C",align:"\u6C34\u5E73\u5BF9\u9F50",valign:"\u5782\u76F4\u5BF9\u9F50",textwrap:"\u81EA\u52A8\u6362\u884C",freeze:"\u51BB\u7ED3",autofilter:"\u81EA\u52A8\u7B5B\u9009",formula:"\u51FD\u6570",more:"\u66F4\u591A"},contextmenu:{copy:"\u590D\u5236",cut:"\u526A\u5207",paste:"\u7C98\u8D34",pasteValue:"\u7C98\u8D34\u6570\u636E",pasteFormat:"\u7C98\u8D34\u683C\u5F0F",hide:"\u9690\u85CF",insertRow:"\u63D2\u5165\u884C",insertColumn:"\u63D2\u5165\u5217",deleteSheet:"\u5220\u9664",deleteRow:"\u5220\u9664\u884C",deleteColumn:"\u5220\u9664\u5217",deleteCell:"\u5220\u9664",deleteCellText:"\u5220\u9664\u6570\u636E",validation:"\u6570\u636E\u9A8C\u8BC1",cellprintable:"\u53EF\u6253\u5370",cellnonprintable:"\u4E0D\u53EF\u6253\u5370",celleditable:"\u53EF\u7F16\u8F91",cellnoneditable:"\u4E0D\u53EF\u7F16\u8F91"},print:{size:"\u7EB8\u5F20\u5927\u5C0F",orientation:"\u65B9\u5411",orientations:["\u6A2A\u5411","\u7EB5\u5411"]},format:{normal:"\u6B63\u5E38",text:"\u6587\u672C",number:"\u6570\u503C",percent:"\u767E\u5206\u6BD4",rmb:"\u4EBA\u6C11\u5E01",usd:"\u7F8E\u5143",eur:"\u6B27\u5143",date:"\u77ED\u65E5\u671F",time:"\u65F6\u95F4",datetime:"\u957F\u65E5\u671F",duration:"\u6301\u7EED\u65F6\u95F4"},formula:{sum:"\u6C42\u548C",average:"\u6C42\u5E73\u5747\u503C",max:"\u6C42\u6700\u5927\u503C",min:"\u6C42\u6700\u5C0F\u503C",concat:"\u5B57\u7B26\u62FC\u63A5",_if:"\u6761\u4EF6\u5224\u65AD",and:"\u548C",or:"\u6216"},validation:{required:"\u6B64\u503C\u5FC5\u586B",notMatch:"\u6B64\u503C\u4E0D\u5339\u914D\u9A8C\u8BC1\u89C4\u5219",between:"\u6B64\u503C\u5E94\u5728 {} \u548C {} \u4E4B\u95F4",notBetween:"\u6B64\u503C\u4E0D\u5E94\u5728 {} \u548C {} \u4E4B\u95F4",notIn:"\u6B64\u503C\u4E0D\u5728\u5217\u8868\u4E2D",equal:"\u6B64\u503C\u5E94\u8BE5\u7B49\u4E8E {}",notEqual:"\u6B64\u503C\u4E0D\u5E94\u8BE5\u7B49\u4E8E {}",lessThan:"\u6B64\u503C\u5E94\u8BE5\u5C0F\u4E8E {}",lessThanEqual:"\u6B64\u503C\u5E94\u8BE5\u5C0F\u4E8E\u7B49\u4E8E {}",greaterThan:"\u6B64\u503C\u5E94\u8BE5\u5927\u4E8E {}",greaterThanEqual:"\u6B64\u503C\u5E94\u8BE5\u5927\u4E8E\u7B49\u4E8E {}"},error:{pasteForMergedCell:"\u65E0\u6CD5\u5BF9\u5408\u5E76\u7684\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C"},calendar:{weeks:["\u65E5","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D"],months:["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"]},button:{next:"\u4E0B\u4E00\u6B65",cancel:"\u53D6\u6D88",remove:"\u5220\u9664",save:"\u4FDD\u5B58",ok:"\u786E\u8BA4"},sort:{desc:"\u964D\u5E8F",asc:"\u5347\u5E8F"},filter:{empty:"\u7A7A\u767D"},dataValidation:{mode:"\u6A21\u5F0F",range:"\u5355\u5143\u533A\u95F4",criteria:"\u6761\u4EF6",modeType:{cell:"\u5355\u5143\u683C",column:"\u5217\u6A21\u5F0F",row:"\u884C\u6A21\u5F0F"},type:{list:"\u5217\u8868",number:"\u6570\u5B57",date:"\u65E5\u671F",phone:"\u624B\u673A\u53F7",email:"\u7535\u5B50\u90AE\u4EF6"},operator:{be:"\u5728\u533A\u95F4",nbe:"\u4E0D\u5728\u533A\u95F4",lt:"\u5C0F\u4E8E",lte:"\u5C0F\u4E8E\u7B49\u4E8E",gt:"\u5927\u4E8E",gte:"\u5927\u4E8E\u7B49\u4E8E",eq:"\u7B49\u4E8E",neq:"\u4E0D\u7B49\u4E8E"}}};window&&window.x_spreadsheet&&(window.x_spreadsheet.$messages=window.x_spreadsheet.$messages||{},window.x_spreadsheet.$messages["zh-cn"]=e),l.default=e}});function g(c){const l=[];return c.SheetNames.forEach(function(o){const e={name:o,rows:{}},t=c.Sheets[o],n=p.utils.decode_range(t["!ref"]);n.s={r:0,c:0},p.utils.sheet_to_json(t,{raw:!1,header:1,range:n}).forEach(function(r,s){const a={};r.forEach(function(u,f){a[f]={text:u};const d=p.utils.encode_cell({r:s,c:f});t[d]!=null&&t[d].f!=null&&(a[f].text="="+t[d].f)}),e.rows[s]={cells:a}}),e.merges=[],(t["!merges"]||[]).forEach(function(r,s){e.rows[r.s.r]==null&&(e.rows[r.s.r]={cells:{}}),e.rows[r.s.r].cells[r.s.c]==null&&(e.rows[r.s.r].cells[r.s.c]={}),e.rows[r.s.r].cells[r.s.c].merge=[r.e.r-r.s.r,r.e.c-r.s.c],e.merges[s]=p.utils.encode_range(r)}),l.push(e)}),l}const z=M("Click to upload"),A=j("div",{id:"xel"},null,-1),N={setup(c){h.locale("zh-cn",window.x_spreadsheet.$messages["zh-cn"]);const l=b([]),o=x(null);let e=null;v(()=>{n()});const t={mode:"read",showToolbar:!0,showGrid:!0,showContextmenu:!0,view:{height:()=>document.documentElement.clientHeight,width:()=>document.documentElement.clientWidth},row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Helvetica",size:10,bold:!1,italic:!1}}},n=()=>{const s="test.xlsx",a=new XMLHttpRequest;a.open("GET",s,!0),a.responseType="arraybuffer",a.send(null),a.onload=function(){if(a.status==200){const u=p.read(a.response);e=new h("#xel",t),e.loadData(g(u))}}},i=s=>{var u;(e==null?void 0:e.getData())&&(document.querySelector("#xel").innerHTML="");const a=new FileReader;a.readAsArrayBuffer((u=s[0])==null?void 0:u.raw),a.onload=f=>{const d=f.target.result,m=new Uint8Array(d),y=p.read(m,{type:"array"});e=new h("#xel",t),e.loadData(g(y)),s.pop()}},r=(s,a)=>{console.log(s,a),typeof FileReader=="function"&&a[0]?i(a):alert("\u5BF9\u4E0D\u8D77\uFF0C\u60A8\u7684\u6D4F\u89C8\u5668\u6682\u4E0D\u652F\u6301\u6B64\u529F\u80FD\uFF01")};return e==null||e.change(s=>{console.log(s,"data")}),e==null||e.validate(),(s,a)=>{const u=E,f=S;return T(),k(O,null,[w(f,{class:"upload-demo",action:"",ref:(d,m)=>{m.fileRef=d,o.value=d},limit:1,"auto-upload":!1,"on-change":r,"file-list":q(l),"show-file-list":!1},{default:_(()=>[w(u,{size:"small",type:"primary"},{default:_(()=>[z]),_:1})]),_:1},8,["file-list"]),A],64)}}};const R=B(N);R.use(C).mount("#app");
